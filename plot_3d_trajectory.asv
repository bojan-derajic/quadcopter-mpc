Ft = out.U.signals.values(:, 1);
Mx = out.U.signals.values(:, 2);
My = out.U.signals.values(:, 3);
Mz = out.U.signals.values(:, 4);

x = out.Y.signals.values(:, 1);
y = out.Y.signals.values(:, 2);
z = out.Y.signals.values(:, 3);
yaw = out.Y.signals.values(:, 4);

r_x = out.R.signals.values(:, 1);
r_y = out.R.signals.values(:, 2);
r_z = out.R.signals.values(:, 3);
r_yaw = out.R.signals.values(:, 4);

figure();
plot3(r_x, r_y, r_z, 'r--', 'linewidth', 1.5);
hold on;
grid on;
plot3(x, y, z, 'b', 'linewidth', 2);
xlabel('x');
ylabel('y');
zlabel('z');
title('Linear MPC');
legend({'Reference', 'True position'})
%%
figure();
subplot(2, 2, 1);
plot(out.R.time, r_x, 'r--', 'linewidth', 1);
hold on;
grid on;
plot(out.Y.time, x, 'b', 'linewidth', 1);
xlabel('t [s]');
ylabel('x [m]');
legend(